<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tech Tigers Mock Test</title>
  <link rel="stylesheet" href="css/all.css">
</head>
<body>

  <div class="container">

    <div class="user-info">
      ğŸ‘‹ Xin chÃ o, <span id="student-name">báº¡n nhá»</span>!
    </div>

    <!-- LOGO FOCUS LEARNING -->
    <div class="header-centered">
      <img src="image/logolv.jpg" alt="Focus Learning Logo" class="logo-absolute">
      <h1>ğŸ“ Tech Tigers Mock Test</h1>
    </div>

    <!-- BÃ i thi -->
    <div>

      <h2>ğŸ§  Part 1: Vocabulary</h2>

      <div class="question">
        <p>1. How old is he?</p>
        <label><input type="radio" name="q3" value="a"> a. He 35 years old.</label>
        <label><input type="radio" name="q3" value="b"> b. His 35 years old.</label>
        <label><input type="radio" name="q3" value="c"> c. Heâ€™s 35 years old.</label>
      </div>

      <div class="question">
        <p>2. March is the third _____ of the year.</p>
        <label><input type="radio" name="q4" value="a"> a. month</label>
        <label><input type="radio" name="q4" value="b"> b. day</label>
        <label><input type="radio" name="q4" value="c"> c. season</label>
      </div>

      <div class="question">
        <p>3. How much is this T-shirt?</p>
        <label><input type="radio" name="q13" value="a"> a. Theyâ€™re $12.</label>
        <label><input type="radio" name="q13" value="b"> b. Is $12.</label>
        <label><input type="radio" name="q13" value="c"> c. Itâ€™s $12.</label>
      </div>

      <div class="question">
        <p>4. I bought new shoes _____ weekend.</p>
        <label><input type="radio" name="q20" value="a"> a. just</label>
        <label><input type="radio" name="q20" value="b"> b. ago</label>
        <label><input type="radio" name="q20" value="c"> c. last</label>
      </div>

      <div class="question">
        <p>5. A: How do I get to the park? B: _____ Main Street.</p>
        <label><input type="radio" name="q26" value="a"> a. In front of</label>
        <label><input type="radio" name="q26" value="b"> b. Turn left</label>
        <label><input type="radio" name="q26" value="c"> c. Go straight down</label>
      </div>

      <h2>ğŸ”§ Part 2: Grammar</h2>

      <div class="question">
        <p>1. Is Jenny in the living room?</p>
        <label><input type="radio" name="q5" value="a"> a. Yes, they are.</label>
        <label><input type="radio" name="q5" value="b"> b. Yes, it is.</label>
        <label><input type="radio" name="q5" value="c"> c. No, she isnâ€™t.</label>
      </div>

      <div class="question">
        <p>2. What time does she get up?</p>
        <label><input type="radio" name="q11" value="a"> a. She always get up at 7 oâ€™clock.</label>
        <label><input type="radio" name="q11" value="b"> b. She always gets up at 7 oâ€™clock.</label>
        <label><input type="radio" name="q11" value="c"> c. She always getting up at 7 oâ€™clock.</label>
      </div>

      <div class="question">
        <p>3. What are you doing?</p>
        <label><input type="radio" name="q14" value="a"> a. Iâ€™m taking a test.</label>
        <label><input type="radio" name="q14" value="b"> b. I take a test.</label>
        <label><input type="radio" name="q14" value="c"> c. Iâ€™m take a test.</label>
      </div>

      <div class="question">
        <p>4. He thinks that dogs are _____ than cats.</p>
        <label><input type="radio" name="q22" value="a"> a. friendliest</label>
        <label><input type="radio" name="q22" value="b"> b. friendly</label>
        <label><input type="radio" name="q22" value="c"> c. friendlier</label>
      </div>

      <div class="question">
        <p>5. The new vaccine _____ to be highly effective against the virus.</p>
        <label><input type="radio" name="q24" value="a"> a. is believed</label>
        <label><input type="radio" name="q24" value="b"> b. was believing</label>
        <label><input type="radio" name="q24" value="c"> c. has believed</label>
      </div>

      <h2>âœï¸ Part 3: Writing</h2>
      <h3>I. HoÃ n thÃ nh cÃ¢u</h3>

      <div class="question">
        <p>1. Yesterday, Tom _____ (3) soccer with his friends in the park.<br>
          They _____ (4) playing when it suddenly rained!</p>
        <input type="text" name="wI2_1" placeholder="Äá»™ng tá»« (3)..." style="margin-bottom: 10px; width: 100%;">
        <input type="text" name="wI2_2" placeholder="Äá»™ng tá»« (4)..." style="width: 100%;">
      </div>

      <div class="question">
        <p>2. Tom _____ (7) like vegetables, but he loves fruit.<br>
          His mom says, 'If you eat veggies, you _____ (8) stronger!'</p>
        <input type="text" name="wI4_1" placeholder="Äá»™ng tá»« (7)..." style="margin-bottom: 10px; width: 100%;">
        <input type="text" name="wI4_2" placeholder="Äá»™ng tá»« (8)..." style="width: 100%;">
      </div>

      <h3>II. Viáº¿t láº¡i cÃ¢u Ä‘Ãºng</h3>

      <div class="question">
        <p>1. use / you / Did / have / to / computer / desktop / a</p>
        <input type="text" name="wII6" placeholder="Viáº¿t láº¡i cÃ¢u Ä‘Ãºng...">
      </div>

      <div class="question">
        <p>2. studied / have / for / I / years / English / three</p>
        <input type="text" name="wII7" placeholder="Viáº¿t láº¡i cÃ¢u Ä‘Ãºng...">
      </div>

      <div class="question">
        <p>3. listening / like / you / Do / music / to</p>
        <input type="text" name="wII10" placeholder="Viáº¿t láº¡i cÃ¢u Ä‘Ãºng...">
      </div>

      <button onclick="submitTest()">âœ… Ná»™p bÃ i</button>
      <div id="result-message" style="margin-top: 20px; font-size: 18px; color: green; text-align: center;"></div>

      <div id="loading" style="display:none; text-align:center; margin-top:15px; color:blue; font-weight:bold;">
        â³ Äang xá»­ lÃ½ bÃ i lÃ m cá»§a báº¡n...
      </div>


    </div>
  </div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
  // GÃ¡n tÃªn há»c sinh vÃ o giao diá»‡n khi táº£i trang
  window.addEventListener("DOMContentLoaded", () => {
    const studentName = localStorage.getItem('studentName');
    if (studentName) {
      document.getElementById("student-name").textContent = studentName;
    }
  });

  function submitTest() {
    const vocabQuestions = ["q3", "q4", "q13", "q20", "q26"];
    const grammarQuestions = ["q5", "q11", "q14", "q22", "q24"];
    const textInputs = ["wI2_1", "wI2_2", "wI4_1", "wI4_2", "wII6", "wII7", "wII10"];

    // Kiá»ƒm tra hoÃ n thÃ nh
    for (let name of [...vocabQuestions, ...grammarQuestions]) {
        if (!document.querySelector(`input[name="${name}"]:checked`)) {
            alert("âš ï¸ Vui lÃ²ng hoÃ n thÃ nh táº¥t cáº£ cÃ¡c cÃ¢u tráº¯c nghiá»‡m trÆ°á»›c khi ná»™p bÃ i.");
            return;
        }
    }
    for (let name of textInputs) {
        const input = document.querySelector(`input[name="${name}"]`);
        if (!input || input.value.trim() === "") {
            alert("âš ï¸ Vui lÃ²ng hoÃ n thÃ nh táº¥t cáº£ cÃ¡c cÃ¢u tá»± luáº­n trÆ°á»›c khi ná»™p bÃ i.");
            return;
        }
    }

    document.querySelector("button").disabled = true;
    document.getElementById("loading").style.display = "block";

    const answerKey = {
        q3: "c", q4: "a", q13: "c", q20: "c", q26: "c",
        q5: "c", q11: "b", q14: "a", q22: "c", q24: "a"
    };

    const writingAnswers = {
        wI2_1: ["played"],
        wI2_2: ["were"],
        wI4_1: ["doesn't", "does not"],
        wI4_2: ["will be"],
        wII6: ["did you use to have a desktop computer", "did you use to have a desktop computer?"],
        wII7: ["i have studied english for three years"],
        wII10: ["do you like listening to music", "do you like listening to music?"]
    };

    // Äiá»ƒm Vocab
    let correctVocab = 0;
    for (const name of vocabQuestions) {
        const selected = document.querySelector(`input[name="${name}"]:checked`);
        if (selected && selected.value === answerKey[name]) correctVocab++;
    }

    // Äiá»ƒm Grammar
    let correctGrammar = 0;
    for (const name of grammarQuestions) {
        const selected = document.querySelector(`input[name="${name}"]:checked`);
        if (selected && selected.value === answerKey[name]) correctGrammar++;
    }

    // Äiá»ƒm Writing
    let correctWriting = 0;
    for (const key in writingAnswers) {
        const input = document.querySelector(`input[name="${key}"]`);
        const userAnswer = input.value.trim().toLowerCase();
        const valids = writingAnswers[key].map(a => a.toLowerCase());
        if (valids.includes(userAnswer)) correctWriting++;
    }

    // Nháº­n xÃ©t
    const vocabComments = {
        5: "Tuyá»‡t vá»i! Con Ä‘Ã£ náº¯m cháº¯c vá»‘n tá»« vá»±ng trong chá»§ Ä‘á» nÃ y. HÃ£y tiáº¿p tá»¥c duy trÃ¬ nhÃ©!",
        4: "Ráº¥t tá»‘t! Con chá»‰ sai 1 cÃ¢u, hÃ£y luyá»‡n táº­p má»—i ngÃ y Ä‘á»ƒ nhá»› lÃ¢u hÆ¡n.",
        3: "KhÃ¡ á»•n, nhÆ°ng con cáº§n Ã´n thÃªm tá»« vá»±ng. Äá»«ng quÃªn luyá»‡n táº­p má»—i ngÃ y!",
        2: "Con cáº§n luyá»‡n táº­p nhiá»u hÆ¡n. HÃ£y Ä‘á»c láº¡i vÃ  lÃ m thÃªm bÃ i táº­p nhÃ©.",
        1: "Con Ä‘ang gáº·p khÃ³ khÄƒn vá»›i tá»« vá»±ng trong chá»§ Ä‘á» nÃ y. HÃ£y báº¯t Ä‘áº§u Ã´n láº¡i tá»« cÆ¡ báº£n.",
        0: "KhÃ´ng sao Ä‘Ã¢u! Con cáº§n há»c láº¡i tá»« vá»±ng thÆ°á»ng xuyÃªn Ä‘á»ƒ cáº£i thiá»‡n nhÃ©."
    };
    const grammarComments = {
        5: "Xuáº¥t sáº¯c! Con Ä‘Ã£ hiá»ƒu vÃ  Ã¡p dá»¥ng Ä‘Ãºng ngá»¯ phÃ¡p.",
        4: "Ráº¥t tá»‘t! Chá»‰ má»™t lá»—i nhá», hÃ£y luyá»‡n táº­p Ä‘á»ƒ cáº£i thiá»‡n hÆ¡n nhÃ©",
        3: "KhÃ¡ á»•n, nhÆ°ng con cáº§n luyá»‡n thÃªm cáº¥u trÃºc cÃ¢u vÃ  cÃ¡ch chia thÃ¬.",
        2: "Con cáº§n Ã´n láº¡i cÃ¡c quy táº¯c ngá»¯ phÃ¡p chÃ­nh con nhÃ©, cá»‘ lÃªn.",
        1: "Con cáº§n bá»• sung cÃ¡c kiáº¿n thá»©c ngá»¯ phÃ¡p cÆ¡ báº£n con nhÃ©",
        0: "KhÃ´ng sao! HÃ£y há»c láº¡i tá»« Ä‘áº§u pháº§n ngá»¯ phÃ¡p nÃ y vÃ  luyá»‡n táº­p thÆ°á»ng xuyÃªn."
    };
    const writingComments = {
        7: "Ráº¥t tá»‘t! Con viáº¿t rÃµ rÃ ng, Ä‘Ãºng cáº¥u trÃºc vÃ  khÃ´ng máº¯c lá»—i chÃ­nh táº£.",
        6: "Ráº¥t tá»‘t! Con viáº¿t rÃµ rÃ ng, Ä‘Ãºng cáº¥u trÃºc vÃ  khÃ´ng máº¯c lá»—i chÃ­nh táº£.",
        5: "Ráº¥t tá»‘t! Con viáº¿t rÃµ rÃ ng, Ä‘Ãºng cáº¥u trÃºc vÃ  khÃ´ng máº¯c lá»—i chÃ­nh táº£.",
        4: "Tá»‘t! Con cáº§n chÃº Ã½ hÆ¡n Ä‘áº¿n dáº¥u cÃ¢u hoáº·c cÃ¡ch diá»…n Ä‘áº¡t Ä‘á»ƒ bÃ i viáº¿t hay hÆ¡n.",
        3: "BÃ i viáº¿t á»•n nhÆ°ng cáº§n luyá»‡n cÃ¡ch dÃ¹ng tá»« vÃ  sáº¯p xáº¿p Ã½.",
        2: "Con cáº§n luyá»‡n viáº¿t cÃ¢u Ä‘áº§y Ä‘á»§ Ã½ vÃ  Ä‘Ãºng ngá»¯ phÃ¡p hÆ¡n.",
        1: "Con gáº·p khÃ³ khÄƒn khi diá»…n Ä‘áº¡t Ã½, hÃ£y báº¯t Ä‘áº§u luyá»‡n viáº¿t cÃ¢u ngáº¯n vÃ  Ä‘Æ¡n giáº£n.",
        0: "KhÃ´ng sao! HÃ£y há»c láº¡i cÃ¡ch viáº¿t cÃ¢u cÆ¡ báº£n vÃ  luyá»‡n tá»«ng bÆ°á»›c."
    };

    // Tá»•ng Ä‘iá»ƒm
    const totalScoreNumeric = correctVocab + correctGrammar + correctWriting;
    const totalQuestions = vocabQuestions.length + grammarQuestions.length + Object.keys(writingAnswers).length;
    const scoreText = `${totalScoreNumeric}/${totalQuestions}`;

    // LÆ°u localStorage
    localStorage.setItem("finalScoreText", scoreText);
    localStorage.setItem("finalScoreNumeric", totalScoreNumeric.toString());
    localStorage.setItem("totalQuestions", totalQuestions.toString());

    localStorage.setItem("vocabScore", correctVocab);
    localStorage.setItem("grammarScore", correctGrammar);
    localStorage.setItem("writingScore", correctWriting);

    localStorage.setItem("vocabComment", vocabComments[correctVocab]);
    localStorage.setItem("grammarComment", grammarComments[correctGrammar]);
    localStorage.setItem("writingComment", writingComments[correctWriting]);

    // Gá»­i dá»¯ liá»‡u lÃªn Google Sheets
    const formData = new FormData();
    formData.append("name", localStorage.getItem("studentName") || "");
    formData.append("birthYear", localStorage.getItem("birthYear") || "");
    formData.append("parentPhone", localStorage.getItem("parentPhone") || "");
    formData.append("score_text", scoreText); // Káº¿t quáº£
    formData.append("score_vocab", correctVocab.toString());
    formData.append("score_grammar", correctGrammar.toString());
    formData.append("score_writing", correctWriting.toString());

    // Gá»™p 3 nháº­n xÃ©t thÃ nh 1 Note
    const noteText = `"${vocabComments[correctVocab]}"\n"${grammarComments[correctGrammar]}"\n"${writingComments[correctWriting]}"`;
    formData.append("note", noteText);

    fetch("https://script.google.com/macros/s/AKfycbw_O2bO1bzlk-1s_lpkkrFJARWAra0n6gCBodRMMlVQM9Ve1I4aQZEGCS18vZsltdtO/exec", {
        method: "POST",
        body: formData
    })
    .then(res => res.json())
    .then(() => window.location.href = "result.html")
    .catch(err => {
        alert("âŒ Lá»—i gá»­i dá»¯ liá»‡u!");
        console.error(err);
        document.querySelector("button").disabled = false;
        document.getElementById("loading").style.display = "none";
    });
}


</script>

</body>
</html>
